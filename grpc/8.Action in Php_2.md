
至于Php下面怎么用……首先，第一步要安装Php（废话）  

接着，要安装Php的grpc扩展（这个不是废话了）  

`https://grpc.io/docs/quickstart/php.html`  

这是官方的教程，不过很遗憾，我的环境是centos，所以要看centos的教程`https://github.com/grpc/grpc/tree/master/src/php#build-from-source`  

先克隆：`git clone -b $(curl -L https://grpc.io/release) https://github.com/grpc/grpc`  

然后安装gRpc的核心库  
```
$ cd grpc
$ git pull --recurse-submodules && git submodule update --init --recursive
$ make
$ sudo make install
```
结果直接就报错了，每次都会在安装的时候报各种错误，不过Go的错误大多还是因为墙的关系。  

先看一个错误：  
```
No package 'libcares' found
```
是缺一个包，直接用`yum install c-ares-devel`安装。  

接着仍然有错：  
```
DEPENDENCY ERROR

You are missing system dependencies that are essential to build grpc,
and the third_party directory doesn't have them:

  cares

Installing the development packages for your system will solve
this issue. Please consult INSTALL to get more information.

If you need information about why these tests failed, run:

  make run_dep_checks

Additionally, since you are in a git clone, you can download the
missing dependencies in third_party by running the following command:

  git submodule update --init

make: *** [stop] Error 1
```
按它的提示，执行检查：  
```
[root@6c6aa7fb57ef grpc]# make run_dep_checks
pkg-config --atleast-version=1.0.2 openssl || true
pkg-config --atleast-version=1.0.1 openssl || true
pkg-config --exists zlib || true
cc -Ithird_party/googletest/googletest/include -Ithird_party/googletest/googlemock/include -Ithird_party/boringssl/include -g -Wall -Wextra -Werror -Wno-long-long -Wno-unused-parameter -DOSATOMIC_USE_INLINED=1 -O2 -fPIC -I. -Iinclude -I/tmp/grpc/gens -DNDEBUG -DINSTALL_PREFIX=\"/usr/local\"       -std=c99 -Wsign-conversion -Wconversion -Wshadow    -o /dev/null test/build/perftools.c -lprofiler -g  -fPIC -Llibs/opt -pthread       || true
test/build/perftools.c:19:33: fatal error: gperftools/profiler.h: No such file or directory
 #include <gperftools/profiler.h>
 ```
发现第三方库的perftools有错，得了，我找到这个库自己安装一下吧。  
`git clone https://github.com/gperftools/gperftools`
下载完成后进目录执行：`./autogen.sh`  
然后：  
```go
./configure
make
make check(可选)
make install
make clean
```

检查通过了  
``` 
[root@6c6aa7fb57ef grpc]# make run_dep_checks
pkg-config --atleast-version=1.0.2 openssl || true
pkg-config --atleast-version=1.0.1 openssl || true
pkg-config --exists zlib || true
cc -Ithird_party/googletest/googletest/include -Ithird_party/googletest/googlemock/include -Ithird_party/boringssl/include -g -Wall -Wextra -Werror -Wno-long-long -Wno-unused-parameter -DOSATOMIC_USE_INLINED=1 -O2 -fPIC -I. -Iinclude -I/tmp/grpc/gens -DNDEBUG -DINSTALL_PREFIX=\"/usr/local\" -DGRPC_HAVE_PERFTOOLS       -std=c99 -Wsign-conversion -Wconversion -Wshadow    -o /dev/null test/build/perftools.c -lprofiler -g  -fPIC -Llibs/opt -pthread       || true
pkg-config --atleast-version=3.0.0 protobuf || true
protoc --version | grep -q libprotoc.3 || true
pkg-config --atleast-version=1.11.0 libcares || true
```
可是仍然编译不了。  
```
[root@6c6aa7fb57ef grpc]# git submodule update --init
Cloning into 'third_party/boringssl-with-bazel'...
fatal: unable to access 'https://boringssl.googlesource.com/boringssl/': Failed to connect to 2404:6800:4008:c03::52: Network is unreachable
Clone of 'https://boringssl.googlesource.com/boringssl' into submodule path 'third_party/boringssl-with-bazel' failed
```
见鬼……在网上查了一下，原来这个gRpc的库里有一个init的操作（就是上面的），而这个操作基于一个叫.gitmodules的文件来下载一些第三方插件。  
